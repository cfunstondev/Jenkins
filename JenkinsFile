pipeline {
    agent any

    stages {
        stage("Build") {
            steps {
                echo "Building project with MSBuild."
            }
        }

        stage("Initial Unit Tests") {
            steps {
                echo "Conducting initial unit tests with MSTest."
            }

            post{
                success{
                    mail to: "cfunstondev@gmail.com",
                    subject: "Unit tests successful."
                    body: "Unit tests log is attached."
                    attachmentsPattern: "/Users/codeyfunston/OneDrive/deakin/it/jenkFinal/unitTestsLog.log"
                }

                failure{
                    mail to: "cfunstondev@gmail.com",
                    subject: "Unit tests failed."
                    body: "Unit tests log is attached."
                    attachmentsPattern: "/Users/codeyfunston/OneDrive/deakin/it/jenkFinal/unitTestsLog.log"
                }
            }
        }

        stage("Code Analysis") {
            steps {
                echo "Analysing code with Roslyn Analyzers."
            }
        }

        stage("Security Scan") {
            steps {
                echo "Scanning for vulnerabilities with OWASP."
            }

            post{
                success{
                    mail to: "cfunstondev@gmail.com",
                    subject: "Security scan successful."
                    body: "Security log is attached."
                    attachmentsPattern: "/Users/codeyfunston/OneDrive/deakin/it/jenkFinal/securityLog.log"
                }

                failure{
                    mail to: "cfunstondev@gmail.com",
                    subject: "Security scan failed."
                    body: "Security log is attached."
                    attachmentsPattern: "/Users/codeyfunston/OneDrive/deakin/it/jenkFinal/securityLog.log"
                }
            }
        }

        stage("Staging Deployment") {
            steps {
                echo "Deploying to Google Compute Engine staging instance with Windows Server."
            }
        }

        stage("Integration Testing") {
            steps {
                echo "Conducting integration tests in the staging environment with MSTest."
            }

            post{
                success{
                    mail to: "cfunstondev@gmail.com",
                    subject: "Integration tests successful."
                    body: "Integration tests log is attached."
                    attachmentsPattern: "/Users/codeyfunston/OneDrive/deakin/it/jenkFinal/integrationTestsLog.log"
                }

                failure{
                    mail to: "cfunstondev@gmail.com",
                    subject: "Integration tests failed."
                    body: "Integration tests log is attached."
                    attachmentsPattern: "/Users/codeyfunston/OneDrive/deakin/it/jenkFinal/integrationTestsLog.log"
                }
            }
        }

        stage("Production Deployment") {
            steps {
                echo "Deploying to Google Compute Engine production instance with Windows Server."
            }
        }
}